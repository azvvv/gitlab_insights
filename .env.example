# ==================== 数据库配置 ====================
DATABASE_URL=postgresql://username:password@localhost:5432/gitlab_insight

# 或者分开配置
# DB_HOST=localhost
# DB_PORT=5432
# DB_NAME=gitlab_insight
# DB_USER=postgres
# DB_PASSWORD=your_password

# ==================== 应用配置 ====================
API_PORT=5000
DEBUG=True
LOG_FILE_PATH=/path/to/gitlab_access.log

# ==================== 日志系统配置 ====================
# 日志级别 (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# 日志格式 (standard, detailed)
LOG_FORMAT=standard

# 是否输出到文件
LOG_TO_FILE=true

# 是否输出到控制台
LOG_TO_CONSOLE=true

# 日志文件目录
LOG_DIR=logs

# 单个日志文件最大大小（字节，默认 10MB）
LOG_FILE_MAX_BYTES=10485760

# 日志文件备份数量
LOG_FILE_BACKUP_COUNT=5

# 是否使用 JSON 格式日志（便于日志分析工具）
LOG_JSON=false

# 慢请求阈值（毫秒，默认 1000ms = 1秒）
# 超过此阈值的请求会被标记为"慢请求"并记录警告日志
# 注意：同步类 API（如 /api/gitlab/sync-*）有独立的更高阈值
SLOW_REQUEST_THRESHOLD=1000

# ==================== 异步任务配置 ====================
# 任务最小执行间隔（秒，默认 300秒 = 5分钟）
# 防止相同任务在此时间窗口内重复执行
TASK_MIN_INTERVAL=300

# 最大并发任务数（默认 10）
# 限制同时运行的后台任务数量
MAX_CONCURRENT_TASKS=10

# ==================== JWT Token 配置 ====================
# JWT 密钥（生产环境必须设置为强随机字符串，至少32字符）
JWT_SECRET_KEY=your-super-secret-key-change-this-in-production-at-least-32-chars

# Token 过期时间（小时）
JWT_EXPIRY_HOURS=24

# ==================== GitLab 配置 ====================
GITLAB_URL=https://gitlab.example.com
GITLAB_TOKEN=your_gitlab_personal_access_token

# ==================== LDAP 认证配置 ====================
# 是否启用 LDAP 认证
LDAP_ENABLED=false

# LDAP 服务器地址
# Active Directory 示例: ldap://ad.example.com
# OpenLDAP 示例: ldap://ldap.example.com
LDAP_HOST=ldap://ldap.example.com

# LDAP 端口（默认 389，SSL 使用 636）
LDAP_PORT=389

# 是否使用 SSL/TLS
LDAP_USE_SSL=false

# LDAP 连接超时（秒）
LDAP_TIMEOUT=10

# LDAP 绑定账户（用于搜索用户，某些 LDAP 服务器需要）
# Active Directory 示例: cn=admin,dc=example,dc=com
# OpenLDAP 示例: cn=admin,dc=example,dc=com
LDAP_BIND_DN=cn=admin,dc=example,dc=com
LDAP_BIND_PASSWORD=admin_password

# LDAP Base DN（搜索基础路径）
# Active Directory 示例: dc=example,dc=com
# OpenLDAP 示例: dc=example,dc=com
LDAP_BASE_DN=dc=example,dc=com

# LDAP 用户搜索过滤器
# Active Directory 使用: (sAMAccountName={username})
# OpenLDAP 使用: (uid={username})
# 使用邮箱登录: (mail={username})
LDAP_USER_SEARCH_FILTER=(uid={username})

# ==================== LDAP 属性映射 ====================
# 用户名属性
# Active Directory: sAMAccountName
# OpenLDAP: uid
LDAP_ATTR_USERNAME=uid

# 邮箱属性
LDAP_ATTR_EMAIL=mail

# 全名属性
# Active Directory: displayName
# OpenLDAP: cn
LDAP_ATTR_FULLNAME=cn

# 名字属性
LDAP_ATTR_FIRSTNAME=givenName

# 姓氏属性
LDAP_ATTR_LASTNAME=sn

# ==================== LDAP 管理员组配置（可选）====================
# 管理员组 DN（留空则不检查组）
# 示例: cn=admins,ou=groups,dc=example,dc=com
LDAP_ADMIN_GROUP=

# 组成员搜索过滤器
LDAP_GROUP_SEARCH_FILTER=(member={user_dn})

# ==================== LDAP 用户同步配置 ====================
# 是否在首次 LDAP 登录时自动创建本地用户
LDAP_AUTO_CREATE_USER=true

# 是否同步 LDAP 用户信息到本地数据库
LDAP_SYNC_USER_INFO=true

